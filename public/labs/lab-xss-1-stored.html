<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"><title>Lab: Stored XSS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style> body { background-color: #0d1117; color: #e0f2f7; } .card { background-color: #161b22; border-color: #00bfff; } .input { background-color: #0d1117; border-color: rgba(0, 191, 255, 0.3); } .btn { background-color: #00bfff; } .comment { border-left-color: #00bfff; } </style>
</head>
<body class="p-8">
    <div class="max-w-xl mx-auto">
        <div class="card p-6 border-2 rounded-lg">
            <h1 class="text-2xl font-bold text-cyan-400 mb-4">Livro de Visitas</h1>
            <input id="nameInput" placeholder="Seu nome" class="input w-full p-2 rounded-md mb-2">
            <textarea id="commentInput" placeholder="Deixe um comentário..." class="input w-full p-2 rounded-md mb-4 h-24"></textarea>
            <button id="submitBtn" class="btn w-full p-2 text-white font-bold rounded-md">Publicar</button>
        </div>
        <div id="comments-section" class="mt-8">
            <h2 class="text-xl font-semibold mb-4">Comentários:</h2>
        </div>
    </div>
    <script>
        // Simula uma base de dados no Local Storage
        const comments = JSON.parse(localStorage.getItem('xss-stored-comments')) || [];
        const commentsSection = document.getElementById('comments-section');

        function renderComments() {
            commentsSection.innerHTML = '<h2 class="text-xl font-semibold mb-4">Comentários:</h2>';
            comments.forEach(c => {
                const commentEl = document.createElement('div');
                commentEl.className = 'comment bg-gray-800 p-4 rounded-md mb-4 border-l-4';
                // VULNERABILIDADE: O conteúdo é inserido diretamente no HTML sem sanitização
                commentEl.innerHTML = `<strong class="text-cyan-400">${c.name}</strong><p class="mt-2 text-gray-300">${c.comment}</p>`;
                commentsSection.appendChild(commentEl);
            });
        }

        document.getElementById('submitBtn').addEventListener('click', () => {
            const name = document.getElementById('nameInput').value;
            const comment = document.getElementById('commentInput').value;
            if (name && comment) {
                comments.push({ name, comment });
                localStorage.setItem('xss-stored-comments', JSON.stringify(comments));
                renderComments();
                document.getElementById('nameInput').value = '';
                document.getElementById('commentInput').value = '';
            }
        });
        renderComments();
    </script>
</body>
</html>